(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{219:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("La importación y exportación de Excel se implementa confiando en "),a("a",{attrs:{href:"https://github.com/SheetJS/js-xlsx",target:"_blank",rel:"noopener noreferrer"}},[t._v("js-xlsx"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/PanJiaChen/vue-element-admin/blob/master/src/vendor/Export2Excel.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Export2Excel.js"),a("OutboundLink")],1),t._v(" está empaquetado en el "),a("code",[t._v("js-xlsx")]),t._v(" para facilitar la exportación de datos.")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("Así que primero necesitas instalar el siguiente comando:")]),t._v(" "),t._m(4),t._m(5),t._v(" "),t._m(6),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Advertencia "),a("Badge",{attrs:{text:"v3.9.1+"}})],1),t._v(" "),a("p",[t._v("El código de compatibilidad para Bolb se ha eliminado en las versiones posteriores de "),a("code",[t._v("v3.9.1 +")]),t._v(". Si necesita ser compatible con navegadores de muy bajo nivel, puede introducir manualmente "),a("a",{attrs:{href:"https://www.npmjs.com/package/blob-polyfill",target:"_blank",rel:"noopener noreferrer"}},[t._v("blob-polyfill"),a("OutboundLink")],1),t._v(" .")])]),t._v(" "),t._m(7),t._v(" "),a("table",[t._m(8),t._v(" "),a("tbody",[t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),a("tr",[a("td",[t._v("bookType")]),t._v(" "),a("td",[t._v("Tipo de archivo de exportación")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("xlsx, csv, txt, "),a("a",{attrs:{href:"https://github.com/SheetJS/js-xlsx#supported-output-formats",target:"_blank",rel:"noopener noreferrer"}},[t._v("more"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("xlsx")])])])]),t._v(" "),t._m(13),t._v(" "),t._m(14),a("ul",[a("li",[a("a",{attrs:{href:"https://panjiachen.github.io/vue-element-admin/#/excel/export-excel",target:"_blank",rel:"noopener noreferrer"}},[t._v("Demo, en línea"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/PanJiaChen/vue-element-admin/blob/master/src/views/excel/exportExcel.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("Código, en línea"),a("OutboundLink")],1)])]),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("Encapsulado "),a("a",{attrs:{href:"https://github.com/PanJiaChen/vue-element-admin/blob/master/src/components/UploadExcel/index.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("UploadExcel"),a("OutboundLink")],1),t._v(" Componente de importación de Excel, haga clic en el soporte y arrastre la carga, también es dependiente en "),a("code",[t._v("js-xlsx")]),t._v(".")]),t._v(" "),a("p",[t._v("Proporciona dos funciones de devolución de llamada:")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._m(18),t._v(" "),t._m(19),a("ul",[a("li",[a("a",{attrs:{href:"https://panjiachen.github.io/vue-element-admin/#/excel/upload-excel",target:"_blank",rel:"noopener noreferrer"}},[t._v("Demo en línea"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/PanJiaChen/vue-element-admin/blob/master/src/views/excel/uploadExcel.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("Código fuente"),a("OutboundLink")],1)])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"excel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#excel","aria-hidden":"true"}},[this._v("#")]),this._v(" Excel")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"exportar-excel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exportar-excel","aria-hidden":"true"}},[this._v("#")]),this._v(" Exportar Excel")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"utilizar"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#utilizar","aria-hidden":"true"}},[this._v("#")]),this._v(" Utilizar")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("Ya que "),a("code",[t._v("Export2Excel")]),t._v(" depende no solo de "),a("code",[t._v("js-xlsx")]),t._v(" sino también de "),a("code",[t._v("file-saver")]),t._v(" y "),a("code",[t._v("script-loader")]),t._v(".")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" xlsx file-saver -S\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" script-loader -S -D\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Dado que el tamaño "),e("code",[this._v("js-xlsx")]),this._v(" todavía es muy grande, la función de exportación no es una función muy común, por lo que se recomienda una carga lenta al usarla. El método de uso es el siguiente:")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/vendor/Export2Excel'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("excel")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  excel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export_json_to_excel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tHeader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Se requiere encabezado")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Datos específicos requeridos")]),t._v("\n    filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'excel-list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n    autoWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n    bookType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xlsx'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"parametros"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#parametros","aria-hidden":"true"}},[this._v("#")]),this._v(" Parámetros")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Parámetros")]),t._v(" "),a("th",[t._v("Descripción")]),t._v(" "),a("th",[t._v("Tipo")]),t._v(" "),a("th",[t._v("Valores Aceptados")]),t._v(" "),a("th",[t._v("Predeterminado")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("header")]),t._v(" "),a("td",[t._v("Exportar encabezado de datos")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("/")]),t._v(" "),a("td",[t._v("[]")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("data")]),t._v(" "),a("td",[t._v("Datos específicos exportados")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("/")]),t._v(" "),a("td",[t._v("[]")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("filename")]),t._v(" "),a("td",[t._v("Nombre de archivo de exportación")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("/")]),t._v(" "),a("td",[t._v("excel-list")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("autoWidth")]),t._v(" "),a("td",[t._v("Si la celda de ancho automático")]),t._v(" "),a("td",[t._v("Boolean")]),t._v(" "),a("td",[t._v("true / false")]),t._v(" "),a("td",[t._v("true")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"ejemplo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ejemplo","aria-hidden":"true"}},[this._v("#")]),this._v(" Ejemplo")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/vendor/Export2Excel'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("excel")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tHeader "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Title'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Author'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Readings'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Date'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list\n  excel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("export_json_to_excel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tHeader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Se requiere encabezado")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Datos específicos requeridos")]),t._v("\n    filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'excel-list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n    autoWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n    bookType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xlsx'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Opcional")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"importacion-de-excel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#importacion-de-excel","aria-hidden":"true"}},[this._v("#")]),this._v(" Importación de Excel")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("beforeUpload")]),this._v(" "),e("p",[this._v("Puedes hacer algunos juicios especiales antes de subir. Por ejemplo, si el tamaño del archivo es mayor que 1 megabyte? Si es superior a 1 megabyte, deja de analizar y muestra un mensaje de error.")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeUpload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" isLt1M "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isLt1M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Por favor, no cargue archivos de más de 1m de tamaño.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'warning'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("onSuccess\nUna función de devolución de llamada que se activa cuando el análisis se realiza correctamente, que devuelve el encabezado y el contenido de la tabla.")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleSuccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" header "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tableData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" results\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tableHeader "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" header\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])}],!1,null,null,null);e.default=n.exports}}]);